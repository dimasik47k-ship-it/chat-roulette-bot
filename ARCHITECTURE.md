# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram Chat Roulette Bot

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–ë–æ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Bot Layer (Telegram API)
- **BotController** - –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- **CommandHandler** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ (/start, /help, etc.)
- **CallbackHandler** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏
- **MessageHandler** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
- **Keyboards** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∞–≤–∏–∞—Ç—É—Ä

### 2. Matchmaking Service
- **MatchmakingService** - —É–º–Ω—ã–π –ø–æ–¥–±–æ—Ä —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–≤
- –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
  - –Ø–∑—ã–∫–∞
  - –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã
  - –ò–Ω—Ç–µ—Ä–µ—Å–æ–≤
  - –°—Ç—Ä–∞–Ω—ã
  - –†–µ–ø—É—Ç–∞—Ü–∏–∏
  - Premium —Å—Ç–∞—Ç—É—Å–∞

### 3. Moderation Service (Moder AI)
- **ModerationService** - AI-–º–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  - –î–µ—Ç–µ–∫—Ç–æ—Ä —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ (NLP)
  - –î–µ—Ç–µ–∫—Ç–æ—Ä —Å–ø–∞–º–∞
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HuggingFace API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –°–∏—Å—Ç–µ–º–∞ –∂–∞–ª–æ–± –∏ –±–∞–Ω–æ–≤
  - –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

### 4. User Service
- **UserService** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –§—É–Ω–∫—Ü–∏–∏:
  - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
  - –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  - –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
  - –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### 5. Chat Service
- **ChatService** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏
- –§—É–Ω–∫—Ü–∏–∏:
  - –°–æ–∑–¥–∞–Ω–∏–µ/–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–∞—Ç–æ–≤
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
  - –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–æ–∫
  - –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤

### 6. Database Layer
- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
  - –ß–∞—Ç—ã
  - –°–æ–æ–±—â–µ–Ω–∏—è
  - –ñ–∞–ª–æ–±—ã
  - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### 7. Cache Layer
- **Redis** - –∫—ç—à –∏ –æ—á–µ—Ä–µ–¥–∏
  - –û—á–µ—Ä–µ–¥—å matchmaking
  - –ê–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã
  - –ö—ç—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –ê–Ω—Ç–∏-—Ñ–ª—É–¥
  - Pub/Sub –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–∏—Å–∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞
```
User ‚Üí BotController ‚Üí MatchmakingService ‚Üí Redis Queue
                                          ‚Üì
                                    Process Queue
                                          ‚Üì
                                  Check Compatibility
                                          ‚Üì
                                    Create Match
                                          ‚Üì
                              ChatService ‚Üí PostgreSQL
                                          ‚Üì
                              Notify Users via Bot
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
```
User Message ‚Üí MessageHandler ‚Üí ModerationService (AI Check)
                                        ‚Üì
                                  Save to PostgreSQL
                                        ‚Üì
                                Send to Partner via Bot
                                        ‚Üì
                                  Add Experience
```

### –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
```
Message ‚Üí Toxicity Detection (NLP)
              ‚Üì
        Spam Detection
              ‚Üì
        ML Classification
              ‚Üì
        External API (optional)
              ‚Üì
        Decision: Allow/Block/Warn
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞
1. **–ê–Ω—Ç–∏-—Ñ–ª—É–¥** - –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ Redis
2. **AI-–º–æ–¥–µ—Ä–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
3. **–°–∏—Å—Ç–µ–º–∞ –∂–∞–ª–æ–±** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ä–µ–ø–æ—Ä—Ç—ã
4. **–ê–≤—Ç–æ-–±–∞–Ω** - –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∂–∞–ª–æ–±
5. **–¢–µ–Ω–µ–≤–æ–π –±–∞–Ω** - —Å–∫—Ä—ã—Ç–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
6. **–ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫** - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –±–æ—Ç–∞ –∑–∞ load balancer
- Redis –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- PostgreSQL —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (JSON)
- –£—Ä–æ–≤–Ω–∏: DEBUG, INFO, WARN, ERROR
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ú–µ—Ç—Ä–∏–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í—Ä–µ–º—è –ø–æ–∏—Å–∫–∞ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–æ–≤
- –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–∞—Ç–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∞–ª–æ–±

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Runtime**: Node.js
- **Bot Framework**: node-telegram-bot-api
- **Database**: PostgreSQL
- **Cache**: Redis
- **NLP**: Natural.js
- **HTTP**: Express
- **AI**: HuggingFace API (optional)

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Development
```bash
npm install
npm run dev
```

### Production
```bash
npm install --production
npm start
```

### Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
docker-compose up -d
```

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **WebRTC** - –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –∑–≤–æ–Ω–∫–∏
2. **–ì—Ä—É–ø–ø—ã** - —á–∞—Ç—ã 3+ —á–µ–ª–æ–≤–µ–∫
3. **–ò–≥—Ä—ã** - –º–∏–Ω–∏-–∏–≥—Ä—ã –≤ —á–∞—Ç–µ
4. **–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥
5. **–¢–µ–º—ã** - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ç–µ–º –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
6. **–°—Ç–∏–∫–µ—Ä—ã** - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä–ø–∞–∫–∏
7. **–ò—Å—Ç–æ—Ä–∏–∏** - –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
8. **–°–æ–æ–±—â–µ—Å—Ç–≤–∞** - —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã
